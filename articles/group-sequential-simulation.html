<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Group sequential design and simulation • gsDesignNB</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Group sequential design and simulation">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gsDesignNB</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/completers-interim-example.html">Group sequential simulation with completers analysis</a></li>
    <li><a class="dropdown-item" href="../articles/group-sequential-simulation.html">Group sequential design and simulation</a></li>
    <li><a class="dropdown-item" href="../articles/sample-size-nbinom.html">Sample size calculation for negative binomial outcomes</a></li>
    <li><a class="dropdown-item" href="../articles/seasonal-simulation.html">Seasonal event simulation</a></li>
    <li><a class="dropdown-item" href="../articles/simulation-example.html">Simulation of recurrent events</a></li>
    <li><a class="dropdown-item" href="../articles/verification-simulation.html">Verification of sample size calculation via simulation</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/keaven/gsDesignNB/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Group sequential design and simulation</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/keaven/gsDesignNB/blob/main/vignettes/group-sequential-simulation.Rmd" class="external-link"><code>vignettes/group-sequential-simulation.Rmd</code></a></small>
      <div class="d-none name"><code>group-sequential-simulation.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://keaven.github.io/gsDesign/" class="external-link">gsDesign</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://keaven.github.io/gsDesignNB/">gsDesignNB</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gt.rstudio.com" class="external-link">gt</a></span><span class="op">)</span></span></code></pre></div>
<p>This vignette demonstrates how to create a group sequential design
for negative binomial outcomes using <code><a href="../reference/gsNBCalendar.html">gsNBCalendar()</a></code> and
simulate the design to confirm design operating characteristics using
<code><a href="../reference/nb_sim.html">nb_sim()</a></code>.</p>
<div class="section level2">
<h2 id="trial-design-parameters">Trial design parameters<a class="anchor" aria-label="anchor" href="#trial-design-parameters"></a>
</h2>
<p>We design a trial with the following characteristics:</p>
<ul>
<li>
<strong>Enrollment:</strong> 12 months with a constant rate</li>
<li>
<strong>Trial Duration:</strong> 24 months</li>
<li>
<strong>Analyses:</strong>
<ul>
<li>Interim 1: 10 months</li>
<li>Interim 2: 18 months</li>
<li>Final: 24 months</li>
</ul>
</li>
<li>
<strong>Event Rates:</strong>
<ul>
<li>Control: 0.125 events per month (1.5 per year)</li>
<li>Experimental: 0.0833 events per month (1.0 per year; rate ratio =
0.67)</li>
</ul>
</li>
<li>
<strong>Dispersion:</strong> 0.5</li>
<li>
<strong>Power:</strong> 90% (beta = 0.1)</li>
<li>
<strong>Alpha:</strong> 0.025 (one-sided) # <strong>event
gap:</strong> 20 days # <strong>dropout rate:</strong> 5% at 1 year #
<strong>max followup:</strong> 12 months</li>
</ul>
<div class="section level3">
<h3 id="sample-size-calculation">Sample size calculation<a class="anchor" aria-label="anchor" href="#sample-size-calculation"></a>
</h3>
<p>First, we calculate the required sample size for a fixed design using
the Zhu and Lakkis method:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Sample size calculation</span></span>
<span><span class="co"># Enrollment: constant rate over 12 months</span></span>
<span><span class="co"># Trial duration: 24 months</span></span>
<span><span class="va">event_gap_val</span> <span class="op">&lt;-</span> <span class="fl">20</span> <span class="op">/</span> <span class="fl">30.4375</span> <span class="co"># Minimum gap between events is 20 days (approx)</span></span>
<span></span>
<span><span class="va">nb_ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sample_size_nbinom.html">sample_size_nbinom</a></span><span class="op">(</span></span>
<span>  lambda1 <span class="op">=</span> <span class="fl">1.5</span> <span class="op">/</span> <span class="fl">12</span>, <span class="co"># Control event rate (per month)</span></span>
<span>  lambda2 <span class="op">=</span> <span class="fl">1.0</span> <span class="op">/</span> <span class="fl">12</span>, <span class="co"># Experimental event rate (per month)</span></span>
<span>  dispersion <span class="op">=</span> <span class="fl">0.5</span>, <span class="co"># Overdispersion parameter</span></span>
<span>  power <span class="op">=</span> <span class="fl">0.9</span>, <span class="co"># 90% power</span></span>
<span>  alpha <span class="op">=</span> <span class="fl">0.025</span>, <span class="co"># One-sided alpha</span></span>
<span>  accrual_rate <span class="op">=</span> <span class="fl">1</span>, <span class="co"># This will be scaled to achieve the target power</span></span>
<span>  accrual_duration <span class="op">=</span> <span class="fl">12</span>, <span class="co"># 12 months enrollment</span></span>
<span>  trial_duration <span class="op">=</span> <span class="fl">24</span>, <span class="co"># 24 months trial</span></span>
<span>  max_followup <span class="op">=</span> <span class="fl">12</span>, <span class="co"># 12 months of follow-up per patient</span></span>
<span>  dropout_rate <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.95</span><span class="op">)</span> <span class="op">/</span> <span class="fl">12</span>, <span class="co"># 5% dropout rate at 1 year</span></span>
<span>  event_gap <span class="op">=</span> <span class="va">event_gap_val</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"zhu"</span> <span class="co"># Zhu and Lakkis sample size method</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print key results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Fixed design"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Fixed design</span></span>
<span><span class="va">nb_ss</span></span>
<span><span class="co">#&gt; Sample size for negative binomial outcome</span></span>
<span><span class="co">#&gt; ==========================================</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Method:          zhu</span></span>
<span><span class="co">#&gt; Sample size:     n1 = 182, n2 = 182, total = 364</span></span>
<span><span class="co">#&gt; Expected events: 414.1 (n1: 245.9, n2: 168.2)</span></span>
<span><span class="co">#&gt; Power: 90%, Alpha: 0.025 (1-sided)</span></span>
<span><span class="co">#&gt; Rates: control = 0.1250, treatment = 0.0833 (RR = 0.6667)</span></span>
<span><span class="co">#&gt; Dispersion: 0.5000, Avg exposure (calendar): 11.70</span></span>
<span><span class="co">#&gt; Avg exposure (at-risk): n1 = 10.81, n2 = 11.09</span></span>
<span><span class="co">#&gt; Event gap: 0.66</span></span>
<span><span class="co">#&gt; Dropout rate: 0.0043</span></span>
<span><span class="co">#&gt; Accrual: 12.0, Trial duration: 24.0</span></span>
<span><span class="co">#&gt; Max follow-up: 12.0</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="group-sequential-design">Group sequential design<a class="anchor" aria-label="anchor" href="#group-sequential-design"></a>
</h3>
<p>Now we convert this a group sequential design with 3 analyses after
10, 18 and 24 months. Note that the final analysis time must be the same
as for the fixed design. The relative enrollment rates will be increased
to increase the sample size as with standard group sequential design
theory. We specify <code>usTime = c(0.1, 0.18, 1)</code> which along
with the <code><a href="https://keaven.github.io/gsDesign/reference/sfLinear.html" class="external-link">sfLinear()</a></code> spending function will spend 10%, 18%
and 100% of the cumulative
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
at the 3 planned analyses regardless of the observed statistical
information at each analysis.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Analysis times (in months)</span></span>
<span><span class="va">analysis_times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">18</span>, <span class="fl">24</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create group sequential design with integer sample sizes</span></span>
<span><span class="va">gs_nb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gsNBCalendar.html">gsNBCalendar</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">nb_ss</span>, <span class="co"># Input fixed design for negative binomial</span></span>
<span>  k <span class="op">=</span> <span class="fl">3</span>, <span class="co"># 3 analyses</span></span>
<span>  test.type <span class="op">=</span> <span class="fl">4</span>, <span class="co"># Two-sided asymmetric, non-binding futility</span></span>
<span>  sfu <span class="op">=</span> <span class="va">sfLinear</span>, <span class="co"># Linear spending function for upper bound</span></span>
<span>  sfupar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">.5</span><span class="op">)</span>, <span class="co"># Identity function</span></span>
<span>  sfl <span class="op">=</span> <span class="va">sfHSD</span>, <span class="co"># HSD spending for lower bound</span></span>
<span>  sflpar <span class="op">=</span> <span class="op">-</span><span class="fl">8</span>, <span class="co"># Conservative futility bound</span></span>
<span>  usTime <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">.18</span>, <span class="fl">1</span><span class="op">)</span>, <span class="co"># Upper spending timing</span></span>
<span>  lsTime <span class="op">=</span> <span class="cn">NULL</span>, <span class="co"># Spending based on information</span></span>
<span>  analysis_times <span class="op">=</span> <span class="va">analysis_times</span> <span class="co"># Calendar times in months</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">gsDesignNB</span><span class="fu">::</span><span class="fu"><a href="../reference/toInteger.html">toInteger</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># Round to integer sample size</span></span></code></pre></div>
<p>Textual group sequential design summary:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">gs_nb</span><span class="op">)</span></span>
<span><span class="co">#&gt; Asymmetric two-sided with non-binding futility bound group sequential design</span></span>
<span><span class="co">#&gt; for negative binomial outcomes, 3 analyses, total sample size 370.0, 90 percent</span></span>
<span><span class="co">#&gt; power, 2.5 percent (1-sided) Type I error. Control rate 0.1250, treatment rate</span></span>
<span><span class="co">#&gt; 0.0833, risk ratio 0.6667, dispersion 0.5000. Accrual duration 12.0, trial</span></span>
<span><span class="co">#&gt; duration 24.0, max follow-up 12.0, event gap 0.66, dropout rate 0.0043, average</span></span>
<span><span class="co">#&gt; exposure (calendar) 11.70, (at-risk n1=10.81, n2=11.09). Randomization ratio</span></span>
<span><span class="co">#&gt; 1:1. Upper spending: Piecewise linear (line points = 0.5) Lower spending:</span></span>
<span><span class="co">#&gt; Hwang-Shih-DeCani (gamma = -8)</span></span>
<span><span class="co">#&gt; Asymmetric two-sided with non-binding futility bound group sequential design</span></span>
<span><span class="co">#&gt; for negative binomial outcomes, 3 analyses, total sample size 370.0, 90 percent</span></span>
<span><span class="co">#&gt; power, 2.5 percent (1-sided) Type I error. Control rate 0.1250, treatment rate</span></span>
<span><span class="co">#&gt; 0.0833, risk ratio 0.6667, dispersion 0.5000. Accrual duration 12.0, trial</span></span>
<span><span class="co">#&gt; duration 24.0, max follow-up 12.0, event gap 0.66, dropout rate 0.0043, average</span></span>
<span><span class="co">#&gt; exposure (calendar) 11.70, (at-risk n1=10.81, n2=11.09). Randomization ratio</span></span>
<span><span class="co">#&gt; 1:1. Upper spending: Piecewise linear (line points = 0.5) Lower spending:</span></span>
<span><span class="co">#&gt; Hwang-Shih-DeCani (gamma = -8)</span></span></code></pre></div>
<p>Tabular summary:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gs_nb</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">gsDesign</span><span class="fu">::</span><span class="fu"><a href="https://keaven.github.io/gsDesign/reference/gsBoundSummary.html" class="external-link">gsBoundSummary</a></span><span class="op">(</span></span>
<span>    deltaname <span class="op">=</span> <span class="st">"RR"</span>,</span>
<span>    logdelta <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    Nname <span class="op">=</span> <span class="st">"Information"</span>,</span>
<span>    timename <span class="op">=</span> <span class="st">"Month"</span>,</span>
<span>    digits <span class="op">=</span> <span class="fl">4</span>,</span>
<span>    ddigits <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_header.html" class="external-link">tab_header</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Group Sequential Design Bounds for Negative Binomial Outcome"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>      <span class="st">"N = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="va">gs_nb</span><span class="op">$</span><span class="va">n_total</span><span class="op">[</span><span class="va">gs_nb</span><span class="op">$</span><span class="va">k</span><span class="op">]</span><span class="op">)</span>,</span>
<span>      <span class="st">", Expected events = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">gs_nb</span><span class="op">$</span><span class="va">nb_design</span><span class="op">$</span><span class="va">total_events</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div id="mwlefoodfi" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#mwlefoodfi table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#mwlefoodfi thead, #mwlefoodfi tbody, #mwlefoodfi tfoot, #mwlefoodfi tr, #mwlefoodfi td, #mwlefoodfi th {
  border-style: none;
}

#mwlefoodfi p {
  margin: 0;
  padding: 0;
}

#mwlefoodfi .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#mwlefoodfi .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#mwlefoodfi .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#mwlefoodfi .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#mwlefoodfi .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mwlefoodfi .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mwlefoodfi .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mwlefoodfi .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#mwlefoodfi .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#mwlefoodfi .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#mwlefoodfi .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#mwlefoodfi .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#mwlefoodfi .gt_spanner_row {
  border-bottom-style: hidden;
}

#mwlefoodfi .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#mwlefoodfi .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#mwlefoodfi .gt_from_md > :first-child {
  margin-top: 0;
}

#mwlefoodfi .gt_from_md > :last-child {
  margin-bottom: 0;
}

#mwlefoodfi .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#mwlefoodfi .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#mwlefoodfi .gt_row_group_first td {
  border-top-width: 2px;
}

#mwlefoodfi .gt_row_group_first th {
  border-top-width: 2px;
}

#mwlefoodfi .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#mwlefoodfi .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#mwlefoodfi .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mwlefoodfi .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#mwlefoodfi .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#mwlefoodfi .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#mwlefoodfi .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mwlefoodfi .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mwlefoodfi .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mwlefoodfi .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_left {
  text-align: left;
}

#mwlefoodfi .gt_center {
  text-align: center;
}

#mwlefoodfi .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#mwlefoodfi .gt_font_normal {
  font-weight: normal;
}

#mwlefoodfi .gt_font_bold {
  font-weight: bold;
}

#mwlefoodfi .gt_font_italic {
  font-style: italic;
}

#mwlefoodfi .gt_super {
  font-size: 65%;
}

#mwlefoodfi .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#mwlefoodfi .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#mwlefoodfi .gt_indent_1 {
  text-indent: 5px;
}

#mwlefoodfi .gt_indent_2 {
  text-indent: 10px;
}

#mwlefoodfi .gt_indent_3 {
  text-indent: 15px;
}

#mwlefoodfi .gt_indent_4 {
  text-indent: 20px;
}

#mwlefoodfi .gt_indent_5 {
  text-indent: 25px;
}

#mwlefoodfi .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#mwlefoodfi div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading">
<td colspan="4" class="gt_heading gt_title gt_font_normal" style>Group Sequential Design Bounds for Negative Binomial Outcome</td>
    </tr>
<tr class="gt_heading">
<td colspan="4" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style>N = 370, Expected events = 414.1</td>
    </tr>
<tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Analysis">Analysis</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Value">Value</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Efficacy">Efficacy</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Futility">Futility</th>
    </tr>
</thead>
<tbody class="gt_table_body">
<tr>
<td headers="Analysis" class="gt_row gt_left">IA 1: 35%</td>
<td headers="Value" class="gt_row gt_left">Z</td>
<td headers="Efficacy" class="gt_row gt_right">2.8070</td>
<td headers="Futility" class="gt_row gt_right">-1.1032</td>
</tr>
<tr>
<td headers="Analysis" class="gt_row gt_left">Information: 28.96</td>
<td headers="Value" class="gt_row gt_left">p (1-sided)</td>
<td headers="Efficacy" class="gt_row gt_right">0.0025</td>
<td headers="Futility" class="gt_row gt_right">0.8650</td>
</tr>
<tr>
<td headers="Analysis" class="gt_row gt_left">Month: 10</td>
<td headers="Value" class="gt_row gt_left">~RR at bound</td>
<td headers="Efficacy" class="gt_row gt_right">0.5931</td>
<td headers="Futility" class="gt_row gt_right">1.2279</td>
</tr>
<tr>
<td headers="Analysis" class="gt_row gt_left"></td>
<td headers="Value" class="gt_row gt_left">P(Cross) if RR=1</td>
<td headers="Efficacy" class="gt_row gt_right">0.0025</td>
<td headers="Futility" class="gt_row gt_right">0.1350</td>
</tr>
<tr>
<td headers="Analysis" class="gt_row gt_left"></td>
<td headers="Value" class="gt_row gt_left">P(Cross) if RR=0.67</td>
<td headers="Efficacy" class="gt_row gt_right">0.2649</td>
<td headers="Futility" class="gt_row gt_right">0.0005</td>
</tr>
<tr>
<td headers="Analysis" class="gt_row gt_left">IA 2: 79%</td>
<td headers="Value" class="gt_row gt_left">Z</td>
<td headers="Efficacy" class="gt_row gt_right">2.8191</td>
<td headers="Futility" class="gt_row gt_right">1.1884</td>
</tr>
<tr>
<td headers="Analysis" class="gt_row gt_left">Information: 65.47</td>
<td headers="Value" class="gt_row gt_left">p (1-sided)</td>
<td headers="Efficacy" class="gt_row gt_right">0.0024</td>
<td headers="Futility" class="gt_row gt_right">0.1173</td>
</tr>
<tr>
<td headers="Analysis" class="gt_row gt_left">Month: 18</td>
<td headers="Value" class="gt_row gt_left">~RR at bound</td>
<td headers="Efficacy" class="gt_row gt_right">0.7054</td>
<td headers="Futility" class="gt_row gt_right">0.8632</td>
</tr>
<tr>
<td headers="Analysis" class="gt_row gt_left"></td>
<td headers="Value" class="gt_row gt_left">P(Cross) if RR=1</td>
<td headers="Efficacy" class="gt_row gt_right">0.0045</td>
<td headers="Futility" class="gt_row gt_right">0.8826</td>
</tr>
<tr>
<td headers="Analysis" class="gt_row gt_left"></td>
<td headers="Value" class="gt_row gt_left">P(Cross) if RR=0.67</td>
<td headers="Efficacy" class="gt_row gt_right">0.6910</td>
<td headers="Futility" class="gt_row gt_right">0.0186</td>
</tr>
<tr>
<td headers="Analysis" class="gt_row gt_left">Final</td>
<td headers="Value" class="gt_row gt_left">Z</td>
<td headers="Efficacy" class="gt_row gt_right">1.9875</td>
<td headers="Futility" class="gt_row gt_right">1.9875</td>
</tr>
<tr>
<td headers="Analysis" class="gt_row gt_left">Information: 82.89</td>
<td headers="Value" class="gt_row gt_left">p (1-sided)</td>
<td headers="Efficacy" class="gt_row gt_right">0.0234</td>
<td headers="Futility" class="gt_row gt_right">0.0234</td>
</tr>
<tr>
<td headers="Analysis" class="gt_row gt_left">Month: 24</td>
<td headers="Value" class="gt_row gt_left">~RR at bound</td>
<td headers="Efficacy" class="gt_row gt_right">0.8036</td>
<td headers="Futility" class="gt_row gt_right">0.8036</td>
</tr>
<tr>
<td headers="Analysis" class="gt_row gt_left"></td>
<td headers="Value" class="gt_row gt_left">P(Cross) if RR=1</td>
<td headers="Efficacy" class="gt_row gt_right">0.0240</td>
<td headers="Futility" class="gt_row gt_right">0.9760</td>
</tr>
<tr>
<td headers="Analysis" class="gt_row gt_left"></td>
<td headers="Value" class="gt_row gt_left">P(Cross) if RR=0.67</td>
<td headers="Efficacy" class="gt_row gt_right">0.9524</td>
<td headers="Futility" class="gt_row gt_right">0.0476</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section level2">
<h2 id="simulation-study">Simulation study<a class="anchor" aria-label="anchor" href="#simulation-study"></a>
</h2>
<p>We now simulate 50 trials to evaluate the power of the group
sequential design assuming design parameters above are correct.</p>
<div class="section level3">
<h3 id="simulation-setup">Simulation setup<a class="anchor" aria-label="anchor" href="#simulation-setup"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">n_sims</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span></span>
<span><span class="co"># Enrollment rate (patients per month) to achieve target sample size</span></span>
<span><span class="va">n_target</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="va">nb_ss</span><span class="op">$</span><span class="va">n_total</span><span class="op">)</span></span>
<span><span class="va">enroll_rate_val</span> <span class="op">&lt;-</span> <span class="va">n_target</span> <span class="op">/</span> <span class="fl">12</span> <span class="co"># All enrolled in 12 months</span></span>
<span></span>
<span><span class="co"># Define enrollment</span></span>
<span><span class="va">enroll_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  rate <span class="op">=</span> <span class="va">enroll_rate_val</span>,</span>
<span>  duration <span class="op">=</span> <span class="fl">12</span> <span class="co"># 12 months enrollment</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define failure rates (with dispersion)</span></span>
<span><span class="va">fail_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  treatment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Control"</span>, <span class="st">"Experimental"</span><span class="op">)</span>,</span>
<span>  rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span> <span class="op">/</span> <span class="fl">12</span>, <span class="fl">1.0</span> <span class="op">/</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>  dispersion <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Dropout rate (5% at 1 year)</span></span>
<span><span class="va">dropout_rate_val</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.95</span><span class="op">)</span></span>
<span><span class="va">dropout_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  treatment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Control"</span>, <span class="st">"Experimental"</span><span class="op">)</span>,</span>
<span>  rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">dropout_rate_val</span>, <span class="va">dropout_rate_val</span><span class="op">)</span>,</span>
<span>  duration <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">100</span><span class="op">)</span> <span class="co"># Long duration</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Maximum follow-up (trial duration from enrollment start)</span></span>
<span><span class="va">max_followup</span> <span class="op">&lt;-</span> <span class="fl">12</span> <span class="co"># 12 months to match design</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="run-simulations">Run simulations<a class="anchor" aria-label="anchor" href="#run-simulations"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Storage for results</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">vector</a></span><span class="op">(</span><span class="st">"list"</span>, <span class="va">n_sims</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">sim</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_sims</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Simulate trial data</span></span>
<span>  <span class="va">sim_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nb_sim.html">nb_sim</a></span><span class="op">(</span></span>
<span>    enroll_rate <span class="op">=</span> <span class="va">enroll_rate</span>,</span>
<span>    fail_rate <span class="op">=</span> <span class="va">fail_rate</span>,</span>
<span>    dropout_rate <span class="op">=</span> <span class="va">dropout_rate</span>,</span>
<span>    max_followup <span class="op">=</span> <span class="va">max_followup</span>,</span>
<span>    n <span class="op">=</span> <span class="va">n_target</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Analyze at each interim</span></span>
<span>  <span class="va">sim_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    sim <span class="op">=</span> <span class="va">sim</span>,</span>
<span>    analysis <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,</span>
<span>    analysis_time <span class="op">=</span> <span class="va">analysis_times</span>,</span>
<span>    n_enrolled <span class="op">=</span> <span class="cn">NA_integer_</span>,</span>
<span>    events_ctrl <span class="op">=</span> <span class="cn">NA_integer_</span>,</span>
<span>    events_exp <span class="op">=</span> <span class="cn">NA_integer_</span>,</span>
<span>    events_total <span class="op">=</span> <span class="cn">NA_integer_</span>,</span>
<span>    exposure_ctrl <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>    exposure_exp <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>    blinded_info <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>    unblinded_info <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>    z_stat <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>    p_value <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>    cross_upper <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    cross_lower <span class="op">=</span> <span class="cn">NA</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="va">stopped</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">stopped</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="co"># Trial already stopped at earlier analysis</span></span>
<span>      <span class="va">sim_results</span><span class="op">$</span><span class="va">cross_upper</span><span class="op">[</span><span class="va">k</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span>      <span class="va">sim_results</span><span class="op">$</span><span class="va">cross_lower</span><span class="op">[</span><span class="va">k</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span>      <span class="kw">next</span></span>
<span>    <span class="op">}</span></span>
<span></span>
<span>    <span class="co"># Cut data at analysis time</span></span>
<span>    <span class="va">cut_time</span> <span class="op">&lt;-</span> <span class="va">analysis_times</span><span class="op">[</span><span class="va">k</span><span class="op">]</span></span>
<span>    <span class="va">cut_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cut_data_by_date.html">cut_data_by_date</a></span><span class="op">(</span><span class="va">sim_data</span>, cut_date <span class="op">=</span> <span class="va">cut_time</span>, event_gap <span class="op">=</span> <span class="va">event_gap_val</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># Count enrolled subjects (those with enroll_time &lt;= cut_time)</span></span>
<span>    <span class="va">enrolled</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">sim_data</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">sim_data</span><span class="op">$</span><span class="va">enroll_time</span> <span class="op">&lt;=</span> <span class="va">cut_time</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">cut_data</span> <span class="op">&lt;-</span> <span class="va">cut_data</span><span class="op">[</span><span class="va">cut_data</span><span class="op">$</span><span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">enrolled</span>, <span class="op">]</span></span>
<span></span>
<span>    <span class="co"># Summary by treatment</span></span>
<span>    <span class="va">summary_dt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="va">cut_data</span><span class="op">)</span><span class="op">[</span></span>
<span>      ,</span>
<span>      <span class="fu">.</span><span class="op">(</span>n <span class="op">=</span> <span class="va">.N</span>, events <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">events</span><span class="op">)</span>, exposure <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">tte</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      by <span class="op">=</span> <span class="va">treatment</span></span>
<span>    <span class="op">]</span></span>
<span></span>
<span>    <span class="va">ctrl_row</span> <span class="op">&lt;-</span> <span class="va">summary_dt</span><span class="op">[</span><span class="va">treatment</span> <span class="op">==</span> <span class="st">"Control"</span><span class="op">]</span></span>
<span>    <span class="va">exp_row</span> <span class="op">&lt;-</span> <span class="va">summary_dt</span><span class="op">[</span><span class="va">treatment</span> <span class="op">==</span> <span class="st">"Experimental"</span><span class="op">]</span></span>
<span></span>
<span>    <span class="va">sim_results</span><span class="op">$</span><span class="va">n_enrolled</span><span class="op">[</span><span class="va">k</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">cut_data</span><span class="op">)</span></span>
<span>    <span class="va">sim_results</span><span class="op">$</span><span class="va">events_ctrl</span><span class="op">[</span><span class="va">k</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ctrl_row</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="va">ctrl_row</span><span class="op">$</span><span class="va">events</span> <span class="kw">else</span> <span class="fl">0</span></span>
<span>    <span class="va">sim_results</span><span class="op">$</span><span class="va">events_exp</span><span class="op">[</span><span class="va">k</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">exp_row</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="va">exp_row</span><span class="op">$</span><span class="va">events</span> <span class="kw">else</span> <span class="fl">0</span></span>
<span>    <span class="va">sim_results</span><span class="op">$</span><span class="va">events_total</span><span class="op">[</span><span class="va">k</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">sim_results</span><span class="op">$</span><span class="va">events_ctrl</span><span class="op">[</span><span class="va">k</span><span class="op">]</span> <span class="op">+</span> <span class="va">sim_results</span><span class="op">$</span><span class="va">events_exp</span><span class="op">[</span><span class="va">k</span><span class="op">]</span></span>
<span>    <span class="va">sim_results</span><span class="op">$</span><span class="va">exposure_ctrl</span><span class="op">[</span><span class="va">k</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ctrl_row</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="va">ctrl_row</span><span class="op">$</span><span class="va">exposure</span> <span class="kw">else</span> <span class="fl">0</span></span>
<span>    <span class="va">sim_results</span><span class="op">$</span><span class="va">exposure_exp</span><span class="op">[</span><span class="va">k</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">exp_row</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="va">exp_row</span><span class="op">$</span><span class="va">exposure</span> <span class="kw">else</span> <span class="fl">0</span></span>
<span></span>
<span>    <span class="co"># Run Mütze test</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">cut_data</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">4</span> <span class="op">&amp;&amp;</span> <span class="va">sim_results</span><span class="op">$</span><span class="va">events_total</span><span class="op">[</span><span class="va">k</span><span class="op">]</span> <span class="op">&gt;=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">test_result</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="../reference/mutze_test.html">mutze_test</a></span><span class="op">(</span><span class="va">cut_data</span><span class="op">)</span>,</span>
<span>        error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="cn">NULL</span></span>
<span>      <span class="op">)</span></span>
<span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">test_result</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">sim_results</span><span class="op">$</span><span class="va">z_stat</span><span class="op">[</span><span class="va">k</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">test_result</span><span class="op">$</span><span class="va">z</span></span>
<span>        <span class="va">sim_results</span><span class="op">$</span><span class="va">p_value</span><span class="op">[</span><span class="va">k</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">test_result</span><span class="op">$</span><span class="va">p_value</span></span>
<span></span>
<span>        <span class="co"># Calculate unblinded information using the variance from the GLM</span></span>
<span>        <span class="va">sim_results</span><span class="op">$</span><span class="va">unblinded_info</span><span class="op">[</span><span class="va">k</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">test_result</span><span class="op">$</span><span class="va">se</span><span class="op">^</span><span class="fl">2</span></span>
<span></span>
<span>        <span class="co"># Calculate blinded information and update bounds</span></span>
<span>        <span class="va">blinded_est</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_blinded_info.html">calculate_blinded_info</a></span><span class="op">(</span></span>
<span>          <span class="va">cut_data</span>,</span>
<span>          ratio <span class="op">=</span> <span class="va">nb_ss</span><span class="op">$</span><span class="va">inputs</span><span class="op">$</span><span class="va">ratio</span>,</span>
<span>          lambda1_planning <span class="op">=</span> <span class="va">nb_ss</span><span class="op">$</span><span class="va">inputs</span><span class="op">$</span><span class="va">lambda1</span>,</span>
<span>          lambda2_planning <span class="op">=</span> <span class="va">nb_ss</span><span class="op">$</span><span class="va">inputs</span><span class="op">$</span><span class="va">lambda2</span>,</span>
<span>          event_gap <span class="op">=</span> <span class="va">event_gap_val</span></span>
<span>        <span class="op">)</span></span>
<span>        <span class="va">sim_results</span><span class="op">$</span><span class="va">blinded_info</span><span class="op">[</span><span class="va">k</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">blinded_est</span><span class="op">$</span><span class="va">blinded_info</span></span>
<span></span>
<span>        <span class="co"># Update design with observed information fraction</span></span>
<span>        <span class="va">max_info</span> <span class="op">&lt;-</span> <span class="va">gs_nb</span><span class="op">$</span><span class="va">n.fix</span></span>
<span>        <span class="co"># If observed info &gt;= max info, this must be the final analysis</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="va">blinded_est</span><span class="op">$</span><span class="va">blinded_info</span> <span class="op">&gt;=</span> <span class="va">max_info</span><span class="op">)</span> <span class="op">{</span></span>
<span>          <span class="co"># Only if not already at the final analysis</span></span>
<span>          <span class="kw">if</span> <span class="op">(</span><span class="va">k</span> <span class="op">&lt;</span> <span class="fl">3</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="co"># Consider this the final analysis for this simulation</span></span>
<span>            <span class="co"># We need to treat this as if k were the final analysis index</span></span>
<span>            <span class="co"># But the loop structure expects k=3 to be final.</span></span>
<span>            <span class="co"># Effectively, we have reached 100% info early.</span></span>
<span>            <span class="va">frac</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span>          <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>            <span class="va">frac</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span>          <span class="op">}</span></span>
<span>        <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">k</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span> <span class="op">{</span></span>
<span>          <span class="va">frac</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span>        <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>          <span class="va">frac</span> <span class="op">&lt;-</span> <span class="va">blinded_est</span><span class="op">$</span><span class="va">blinded_info</span> <span class="op">/</span> <span class="va">max_info</span></span>
<span>        <span class="op">}</span></span>
<span></span>
<span>        <span class="co"># Current timing</span></span>
<span>        <span class="va">current_timing</span> <span class="op">&lt;-</span> <span class="va">gs_nb</span><span class="op">$</span><span class="va">timing</span></span>
<span>        <span class="va">current_timing</span><span class="op">[</span><span class="va">k</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">frac</span></span>
<span></span>
<span>        <span class="co"># Safety check for timing order</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="va">k</span> <span class="op">&gt;</span> <span class="fl">1</span> <span class="op">&amp;&amp;</span> <span class="va">current_timing</span><span class="op">[</span><span class="va">k</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="va">current_timing</span><span class="op">[</span><span class="va">k</span> <span class="op">-</span> <span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="va">current_timing</span><span class="op">[</span><span class="va">k</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">current_timing</span><span class="op">[</span><span class="va">k</span> <span class="op">-</span> <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fl">0.001</span></span>
<span></span>
<span>        <span class="co"># If we have reached full information early (frac &gt;= 1), adjust timing</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="va">frac</span> <span class="op">&gt;=</span> <span class="fl">1</span> <span class="op">&amp;&amp;</span> <span class="va">k</span> <span class="op">&lt;</span> <span class="fl">3</span><span class="op">)</span> <span class="op">{</span></span>
<span>          <span class="co"># Set current timing to 1</span></span>
<span>          <span class="va">current_timing</span><span class="op">[</span><span class="va">k</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span>          <span class="co"># Set subsequent timings to 1 as well (though they won't be reached ideally,</span></span>
<span>          <span class="co"># gsDesign needs valid input)</span></span>
<span>          <span class="va">current_timing</span><span class="op">[</span><span class="op">(</span><span class="va">k</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span>          <span class="co"># Note: gsDesign might complain if timing is 1 at interim.</span></span>
<span>          <span class="co"># Actually gsDesign requires timing to be increasing and &lt; 1 for interims usually.</span></span>
<span>          <span class="co"># If information fraction &gt; 1, we should probably stop the trial.</span></span>
<span>          <span class="va">stopped</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span>        <span class="op">}</span></span>
<span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="va">k</span> <span class="op">&lt;</span> <span class="fl">3</span> <span class="op">&amp;&amp;</span> <span class="va">current_timing</span><span class="op">[</span><span class="va">k</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="va">current_timing</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span></span>
<span>          <span class="co"># Ensure strict monotonicity if not already at 1</span></span>
<span>          <span class="kw">if</span> <span class="op">(</span><span class="va">current_timing</span><span class="op">[</span><span class="va">k</span><span class="op">]</span> <span class="op">&lt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="va">current_timing</span><span class="op">[</span><span class="va">k</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">current_timing</span><span class="op">[</span><span class="va">k</span><span class="op">]</span> <span class="op">+</span> <span class="fl">0.001</span>, <span class="fl">0.999</span><span class="op">)</span></span>
<span>          <span class="op">}</span></span>
<span>        <span class="op">}</span></span>
<span></span>
<span>        <span class="co"># Recompute bounds</span></span>
<span>        <span class="co"># We only recompute if we haven't exceeded information</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="va">frac</span> <span class="op">&lt;=</span> <span class="fl">1</span> <span class="op">||</span> <span class="va">k</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span> <span class="op">{</span></span>
<span>          <span class="va">temp_gs</span> <span class="op">&lt;-</span> <span class="fu">gsDesign</span><span class="fu">::</span><span class="fu"><a href="https://keaven.github.io/gsDesign/reference/gsDesign.html" class="external-link">gsDesign</a></span><span class="op">(</span></span>
<span>            k <span class="op">=</span> <span class="fl">3</span>,</span>
<span>            test.type <span class="op">=</span> <span class="fl">4</span>,</span>
<span>            alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>            beta <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>            sfu <span class="op">=</span> <span class="fu">gsDesign</span><span class="fu">::</span><span class="va"><a href="https://keaven.github.io/gsDesign/reference/sfLinear.html" class="external-link">sfLinear</a></span>, sfupar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">.5</span><span class="op">)</span>,</span>
<span>            sfl <span class="op">=</span> <span class="fu">gsDesign</span><span class="fu">::</span><span class="va"><a href="https://keaven.github.io/gsDesign/reference/sfHSD.html" class="external-link">sfHSD</a></span>, sflpar <span class="op">=</span> <span class="op">-</span><span class="fl">8</span>,</span>
<span>            usTime <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">.18</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>            timing <span class="op">=</span> <span class="va">current_timing</span>,</span>
<span>            n.fix <span class="op">=</span> <span class="va">max_info</span></span>
<span>          <span class="op">)</span></span>
<span></span>
<span>          <span class="va">upper_bound</span> <span class="op">&lt;-</span> <span class="va">temp_gs</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">bound</span><span class="op">[</span><span class="va">k</span><span class="op">]</span></span>
<span>          <span class="va">lower_bound</span> <span class="op">&lt;-</span> <span class="va">temp_gs</span><span class="op">$</span><span class="va">lower</span><span class="op">$</span><span class="va">bound</span><span class="op">[</span><span class="va">k</span><span class="op">]</span></span>
<span></span>
<span>          <span class="co"># Check boundaries (one-sided: reject if z &lt; -upper bound for benefit)</span></span>
<span>          <span class="co"># For rate ratio &lt; 1 (experimental better), log(RR) &lt; 0, so z &lt; 0</span></span>
<span>          <span class="va">z_eff</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="va">test_result</span><span class="op">$</span><span class="va">z</span> <span class="co"># Flip sign for efficacy direction</span></span>
<span></span>
<span>          <span class="va">sim_results</span><span class="op">$</span><span class="va">cross_upper</span><span class="op">[</span><span class="va">k</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">z_eff</span> <span class="op">&gt;</span> <span class="va">upper_bound</span></span>
<span>          <span class="va">sim_results</span><span class="op">$</span><span class="va">cross_lower</span><span class="op">[</span><span class="va">k</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">z_eff</span> <span class="op">&lt;</span> <span class="va">lower_bound</span></span>
<span></span>
<span>          <span class="kw">if</span> <span class="op">(</span><span class="va">sim_results</span><span class="op">$</span><span class="va">cross_upper</span><span class="op">[</span><span class="va">k</span><span class="op">]</span> <span class="op">||</span> <span class="va">sim_results</span><span class="op">$</span><span class="va">cross_lower</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="va">stopped</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span>          <span class="op">}</span></span>
<span>        <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>          <span class="co"># Information limit reached early</span></span>
<span>          <span class="co"># We should check against final bound, but technically this is an overrun</span></span>
<span>          <span class="co"># For simplicity here, we stop.</span></span>
<span>          <span class="va">stopped</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span>        <span class="op">}</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">results</span><span class="op">[[</span><span class="va">sim</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">sim_results</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Combine all results</span></span>
<span><span class="va">all_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">results</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="simulation-results-summary">Simulation results summary<a class="anchor" aria-label="anchor" href="#simulation-results-summary"></a>
</h2>
<div class="section level3">
<h3 id="events-and-exposure-by-analysis">Events and exposure by analysis<a class="anchor" aria-label="anchor" href="#events-and-exposure-by-analysis"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Summarize by analysis</span></span>
<span><span class="va">summary_by_analysis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="va">all_results</span><span class="op">)</span><span class="op">[</span></span>
<span>  ,</span>
<span>  <span class="fu">.</span><span class="op">(</span></span>
<span>    mean_enrolled <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">n_enrolled</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    mean_events_total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">events_total</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    mean_events_ctrl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">events_ctrl</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    mean_events_exp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">events_exp</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    mean_exposure_ctrl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">exposure_ctrl</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    mean_exposure_exp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">exposure_exp</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    mean_z <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">z_stat</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    sd_z <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">z_stat</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  by <span class="op">=</span> <span class="fu">.</span><span class="op">(</span><span class="va">analysis</span>, <span class="va">analysis_time</span><span class="op">)</span></span>
<span><span class="op">]</span></span>
<span></span>
<span><span class="va">summary_by_analysis</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_header.html" class="external-link">tab_header</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Summary Statistics by Analysis"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/cols_label.html" class="external-link">cols_label</a></span><span class="op">(</span></span>
<span>    analysis <span class="op">=</span> <span class="st">"Analysis"</span>,</span>
<span>    analysis_time <span class="op">=</span> <span class="st">"Time (months)"</span>,</span>
<span>    mean_enrolled <span class="op">=</span> <span class="st">"N Enrolled"</span>,</span>
<span>    mean_events_total <span class="op">=</span> <span class="st">"Total Events"</span>,</span>
<span>    mean_events_ctrl <span class="op">=</span> <span class="st">"Ctrl Events"</span>,</span>
<span>    mean_events_exp <span class="op">=</span> <span class="st">"Exp Events"</span>,</span>
<span>    mean_exposure_ctrl <span class="op">=</span> <span class="st">"Ctrl Exposure"</span>,</span>
<span>    mean_exposure_exp <span class="op">=</span> <span class="st">"Exp Exposure"</span>,</span>
<span>    mean_z <span class="op">=</span> <span class="st">"Mean Z"</span>,</span>
<span>    sd_z <span class="op">=</span> <span class="st">"SD Z"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/fmt_number.html" class="external-link">fmt_number</a></span><span class="op">(</span>decimals <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div id="havvzvxvem" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#havvzvxvem table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#havvzvxvem thead, #havvzvxvem tbody, #havvzvxvem tfoot, #havvzvxvem tr, #havvzvxvem td, #havvzvxvem th {
  border-style: none;
}

#havvzvxvem p {
  margin: 0;
  padding: 0;
}

#havvzvxvem .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#havvzvxvem .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#havvzvxvem .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#havvzvxvem .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#havvzvxvem .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#havvzvxvem .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#havvzvxvem .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#havvzvxvem .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#havvzvxvem .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#havvzvxvem .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#havvzvxvem .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#havvzvxvem .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#havvzvxvem .gt_spanner_row {
  border-bottom-style: hidden;
}

#havvzvxvem .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#havvzvxvem .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#havvzvxvem .gt_from_md > :first-child {
  margin-top: 0;
}

#havvzvxvem .gt_from_md > :last-child {
  margin-bottom: 0;
}

#havvzvxvem .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#havvzvxvem .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#havvzvxvem .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#havvzvxvem .gt_row_group_first td {
  border-top-width: 2px;
}

#havvzvxvem .gt_row_group_first th {
  border-top-width: 2px;
}

#havvzvxvem .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#havvzvxvem .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#havvzvxvem .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#havvzvxvem .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#havvzvxvem .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#havvzvxvem .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#havvzvxvem .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#havvzvxvem .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#havvzvxvem .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#havvzvxvem .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#havvzvxvem .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#havvzvxvem .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#havvzvxvem .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#havvzvxvem .gt_left {
  text-align: left;
}

#havvzvxvem .gt_center {
  text-align: center;
}

#havvzvxvem .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#havvzvxvem .gt_font_normal {
  font-weight: normal;
}

#havvzvxvem .gt_font_bold {
  font-weight: bold;
}

#havvzvxvem .gt_font_italic {
  font-style: italic;
}

#havvzvxvem .gt_super {
  font-size: 65%;
}

#havvzvxvem .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#havvzvxvem .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#havvzvxvem .gt_indent_1 {
  text-indent: 5px;
}

#havvzvxvem .gt_indent_2 {
  text-indent: 10px;
}

#havvzvxvem .gt_indent_3 {
  text-indent: 15px;
}

#havvzvxvem .gt_indent_4 {
  text-indent: 20px;
}

#havvzvxvem .gt_indent_5 {
  text-indent: 25px;
}

#havvzvxvem .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#havvzvxvem div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading">
<td colspan="10" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>Summary Statistics by Analysis</td>
    </tr>
<tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="analysis">Analysis</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="analysis_time">Time (months)</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="mean_enrolled">N Enrolled</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="mean_events_total">Total Events</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="mean_events_ctrl">Ctrl Events</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="mean_events_exp">Exp Events</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="mean_exposure_ctrl">Ctrl Exposure</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="mean_exposure_exp">Exp Exposure</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="mean_z">Mean Z</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="sd_z">SD Z</th>
    </tr>
</thead>
<tbody class="gt_table_body">
<tr>
<td headers="analysis" class="gt_row gt_right">1.00</td>
<td headers="analysis_time" class="gt_row gt_right">10.00</td>
<td headers="mean_enrolled" class="gt_row gt_right">303.06</td>
<td headers="mean_events_total" class="gt_row gt_right">124.36</td>
<td headers="mean_events_ctrl" class="gt_row gt_right">74.52</td>
<td headers="mean_events_exp" class="gt_row gt_right">49.84</td>
<td headers="mean_exposure_ctrl" class="gt_row gt_right">594.85</td>
<td headers="mean_exposure_exp" class="gt_row gt_right">612.27</td>
<td headers="mean_z" class="gt_row gt_right">−2.09</td>
<td headers="sd_z" class="gt_row gt_right">1.08</td>
</tr>
<tr>
<td headers="analysis" class="gt_row gt_right">2.00</td>
<td headers="analysis_time" class="gt_row gt_right">18.00</td>
<td headers="mean_enrolled" class="gt_row gt_right">364.00</td>
<td headers="mean_events_total" class="gt_row gt_right">284.73</td>
<td headers="mean_events_ctrl" class="gt_row gt_right">167.00</td>
<td headers="mean_events_exp" class="gt_row gt_right">117.73</td>
<td headers="mean_exposure_ctrl" class="gt_row gt_right">1,358.08</td>
<td headers="mean_exposure_exp" class="gt_row gt_right">1,389.36</td>
<td headers="mean_z" class="gt_row gt_right">−2.68</td>
<td headers="sd_z" class="gt_row gt_right">1.01</td>
</tr>
<tr>
<td headers="analysis" class="gt_row gt_right">3.00</td>
<td headers="analysis_time" class="gt_row gt_right">24.00</td>
<td headers="mean_enrolled" class="gt_row gt_right">364.00</td>
<td headers="mean_events_total" class="gt_row gt_right">315.37</td>
<td headers="mean_events_ctrl" class="gt_row gt_right">178.53</td>
<td headers="mean_events_exp" class="gt_row gt_right">136.84</td>
<td headers="mean_exposure_ctrl" class="gt_row gt_right">1,515.64</td>
<td headers="mean_exposure_exp" class="gt_row gt_right">1,555.03</td>
<td headers="mean_z" class="gt_row gt_right">−2.16</td>
<td headers="sd_z" class="gt_row gt_right">0.60</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level3">
<h3 id="statistical-information">Statistical information<a class="anchor" aria-label="anchor" href="#statistical-information"></a>
</h3>
<p>The statistical information at each analysis is proportional to the
precision of the treatment effect estimate. For negative binomial
outcomes, this relates to the total exposure and event counts. We note
that the asymptotic information approximation overstates the information
at the each analysis. However, the power approximation still worked
reasonably well. This evaluated in a larger simulation study in the
vignette <code>verification-simulation.Rmd</code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Summarize information (using blinded estimate from simulation)</span></span>
<span><span class="va">info_by_analysis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="va">all_results</span><span class="op">)</span><span class="op">[</span></span>
<span>  ,</span>
<span>  <span class="fu">.</span><span class="op">(</span></span>
<span>    mean_blinded <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">blinded_info</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    mean_unblinded <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">unblinded_info</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  by <span class="op">=</span> <span class="va">analysis</span></span>
<span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Add planned information from design</span></span>
<span><span class="va">info_by_analysis</span><span class="op">[</span>, <span class="va">planned_info</span> <span class="op">:=</span> <span class="va">gs_nb</span><span class="op">$</span><span class="va">n.I</span><span class="op">[</span><span class="va">analysis</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Normalize to get observed information fractions (relative to planned max)</span></span>
<span><span class="va">max_planned_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">gs_nb</span><span class="op">$</span><span class="va">n.I</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">info_by_analysis</span><span class="op">[</span>, <span class="va">observed_frac_blinded</span> <span class="op">:=</span> <span class="va">mean_blinded</span> <span class="op">/</span> <span class="va">max_planned_info</span><span class="op">]</span></span>
<span><span class="va">info_by_analysis</span><span class="op">[</span>, <span class="va">observed_frac_unblinded</span> <span class="op">:=</span> <span class="va">mean_unblinded</span> <span class="op">/</span> <span class="va">max_planned_info</span><span class="op">]</span></span>
<span><span class="va">info_by_analysis</span><span class="op">[</span>, <span class="va">planned_info_frac</span> <span class="op">:=</span> <span class="va">planned_info</span> <span class="op">/</span> <span class="va">max_planned_info</span><span class="op">]</span></span>
<span></span>
<span><span class="va">info_by_analysis</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_header.html" class="external-link">tab_header</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Information by Analysis"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/cols_label.html" class="external-link">cols_label</a></span><span class="op">(</span></span>
<span>    analysis <span class="op">=</span> <span class="st">"Analysis"</span>,</span>
<span>    mean_blinded <span class="op">=</span> <span class="st">"Mean Info (Blinded)"</span>,</span>
<span>    mean_unblinded <span class="op">=</span> <span class="st">"Mean Info (Unblinded)"</span>,</span>
<span>    planned_info <span class="op">=</span> <span class="st">"Planned Info"</span>,</span>
<span>    planned_info_frac <span class="op">=</span> <span class="st">"Planned Frac"</span>,</span>
<span>    observed_frac_blinded <span class="op">=</span> <span class="st">"Obs Frac (Blind)"</span>,</span>
<span>    observed_frac_unblinded <span class="op">=</span> <span class="st">"Obs Frac (Unblind)"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/fmt_number.html" class="external-link">fmt_number</a></span><span class="op">(</span>decimals <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<div id="pnkzascipb" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#pnkzascipb table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#pnkzascipb thead, #pnkzascipb tbody, #pnkzascipb tfoot, #pnkzascipb tr, #pnkzascipb td, #pnkzascipb th {
  border-style: none;
}

#pnkzascipb p {
  margin: 0;
  padding: 0;
}

#pnkzascipb .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#pnkzascipb .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#pnkzascipb .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#pnkzascipb .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#pnkzascipb .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pnkzascipb .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pnkzascipb .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pnkzascipb .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#pnkzascipb .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#pnkzascipb .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#pnkzascipb .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#pnkzascipb .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#pnkzascipb .gt_spanner_row {
  border-bottom-style: hidden;
}

#pnkzascipb .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#pnkzascipb .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#pnkzascipb .gt_from_md > :first-child {
  margin-top: 0;
}

#pnkzascipb .gt_from_md > :last-child {
  margin-bottom: 0;
}

#pnkzascipb .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#pnkzascipb .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#pnkzascipb .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#pnkzascipb .gt_row_group_first td {
  border-top-width: 2px;
}

#pnkzascipb .gt_row_group_first th {
  border-top-width: 2px;
}

#pnkzascipb .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pnkzascipb .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#pnkzascipb .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#pnkzascipb .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pnkzascipb .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pnkzascipb .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#pnkzascipb .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#pnkzascipb .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#pnkzascipb .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pnkzascipb .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pnkzascipb .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pnkzascipb .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pnkzascipb .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pnkzascipb .gt_left {
  text-align: left;
}

#pnkzascipb .gt_center {
  text-align: center;
}

#pnkzascipb .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#pnkzascipb .gt_font_normal {
  font-weight: normal;
}

#pnkzascipb .gt_font_bold {
  font-weight: bold;
}

#pnkzascipb .gt_font_italic {
  font-style: italic;
}

#pnkzascipb .gt_super {
  font-size: 65%;
}

#pnkzascipb .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#pnkzascipb .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#pnkzascipb .gt_indent_1 {
  text-indent: 5px;
}

#pnkzascipb .gt_indent_2 {
  text-indent: 10px;
}

#pnkzascipb .gt_indent_3 {
  text-indent: 15px;
}

#pnkzascipb .gt_indent_4 {
  text-indent: 20px;
}

#pnkzascipb .gt_indent_5 {
  text-indent: 25px;
}

#pnkzascipb .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#pnkzascipb div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading">
<td colspan="7" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>Information by Analysis</td>
    </tr>
<tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="analysis">Analysis</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="mean_blinded">Mean Info (Blinded)</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="mean_unblinded">Mean Info (Unblinded)</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="planned_info">Planned Info</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="observed_frac_blinded">Obs Frac (Blind)</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="observed_frac_unblinded">Obs Frac (Unblind)</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="planned_info_frac">Planned Frac</th>
    </tr>
</thead>
<tbody class="gt_table_body">
<tr>
<td headers="analysis" class="gt_row gt_right">1.000</td>
<td headers="mean_blinded" class="gt_row gt_right">24.218</td>
<td headers="mean_unblinded" class="gt_row gt_right">23.007</td>
<td headers="planned_info" class="gt_row gt_right">28.958</td>
<td headers="observed_frac_blinded" class="gt_row gt_right">0.292</td>
<td headers="observed_frac_unblinded" class="gt_row gt_right">0.278</td>
<td headers="planned_info_frac" class="gt_row gt_right">0.349</td>
</tr>
<tr>
<td headers="analysis" class="gt_row gt_right">2.000</td>
<td headers="mean_blinded" class="gt_row gt_right">50.715</td>
<td headers="mean_unblinded" class="gt_row gt_right">49.732</td>
<td headers="planned_info" class="gt_row gt_right">65.465</td>
<td headers="observed_frac_blinded" class="gt_row gt_right">0.612</td>
<td headers="observed_frac_unblinded" class="gt_row gt_right">0.600</td>
<td headers="planned_info_frac" class="gt_row gt_right">0.790</td>
</tr>
<tr>
<td headers="analysis" class="gt_row gt_right">3.000</td>
<td headers="mean_blinded" class="gt_row gt_right">55.238</td>
<td headers="mean_unblinded" class="gt_row gt_right">54.205</td>
<td headers="planned_info" class="gt_row gt_right">82.887</td>
<td headers="observed_frac_blinded" class="gt_row gt_right">0.666</td>
<td headers="observed_frac_unblinded" class="gt_row gt_right">0.654</td>
<td headers="planned_info_frac" class="gt_row gt_right">1.000</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level3">
<h3 id="boundary-crossings-and-power">Boundary crossings and power<a class="anchor" aria-label="anchor" href="#boundary-crossings-and-power"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate crossing probabilities</span></span>
<span><span class="va">crossing_summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="va">all_results</span><span class="op">)</span><span class="op">[</span></span>
<span>  ,</span>
<span>  <span class="fu">.</span><span class="op">(</span></span>
<span>    n_cross_upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">cross_upper</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    n_cross_lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">cross_lower</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    n_continue <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">!</span><span class="va">cross_upper</span> <span class="op">&amp;</span> <span class="op">!</span><span class="va">cross_lower</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  by <span class="op">=</span> <span class="va">analysis</span></span>
<span><span class="op">]</span></span>
<span></span>
<span><span class="va">crossing_summary</span><span class="op">[</span>, <span class="va">prob_cross_upper</span> <span class="op">:=</span> <span class="va">n_cross_upper</span> <span class="op">/</span> <span class="va">n_sims</span><span class="op">]</span></span>
<span><span class="va">crossing_summary</span><span class="op">[</span>, <span class="va">prob_cross_lower</span> <span class="op">:=</span> <span class="va">n_cross_lower</span> <span class="op">/</span> <span class="va">n_sims</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Cumulative power (Sim)</span></span>
<span><span class="va">crossing_summary</span><span class="op">[</span>, <span class="va">cum_prob_cross_upper</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">prob_cross_upper</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Cumulative power (Design)</span></span>
<span><span class="co"># Drift parameter for alternative: |log(RR)| * sqrt(I_max)</span></span>
<span><span class="co"># Note: gs_nb$n.fix is the information at final analysis</span></span>
<span><span class="va">log_rr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">nb_ss</span><span class="op">$</span><span class="va">inputs</span><span class="op">$</span><span class="va">lambda2</span> <span class="op">/</span> <span class="va">nb_ss</span><span class="op">$</span><span class="va">inputs</span><span class="op">$</span><span class="va">lambda1</span><span class="op">)</span></span>
<span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">log_rr</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">gs_nb</span><span class="op">$</span><span class="va">n.fix</span><span class="op">)</span></span>
<span><span class="va">design_probs</span> <span class="op">&lt;-</span> <span class="fu">gsDesign</span><span class="fu">::</span><span class="fu"><a href="https://keaven.github.io/gsDesign/reference/gsProbability.html" class="external-link">gsProbability</a></span><span class="op">(</span>d <span class="op">=</span> <span class="va">gs_nb</span>, theta <span class="op">=</span> <span class="va">theta</span><span class="op">)</span></span>
<span><span class="va">crossing_summary</span><span class="op">[</span>, <span class="va">design_cum_power</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">design_probs</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">prob</span><span class="op">)</span><span class="op">[</span><span class="va">analysis</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="va">crossing_summary</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">analysis</span>, <span class="va">n_cross_upper</span>, <span class="va">cum_prob_cross_upper</span>, <span class="va">design_cum_power</span><span class="op">)</span><span class="op">]</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_header.html" class="external-link">tab_header</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Boundary Crossing and Power"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/cols_label.html" class="external-link">cols_label</a></span><span class="op">(</span></span>
<span>    analysis <span class="op">=</span> <span class="st">"Analysis"</span>,</span>
<span>    n_cross_upper <span class="op">=</span> <span class="st">"N Cross Upper"</span>,</span>
<span>    cum_prob_cross_upper <span class="op">=</span> <span class="st">"Cum Power (Sim)"</span>,</span>
<span>    design_cum_power <span class="op">=</span> <span class="st">"Cum Power (Design)"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/fmt_number.html" class="external-link">fmt_number</a></span><span class="op">(</span>columns <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">"power"</span><span class="op">)</span>, decimals <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<div id="kguqzvojsv" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#kguqzvojsv table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#kguqzvojsv thead, #kguqzvojsv tbody, #kguqzvojsv tfoot, #kguqzvojsv tr, #kguqzvojsv td, #kguqzvojsv th {
  border-style: none;
}

#kguqzvojsv p {
  margin: 0;
  padding: 0;
}

#kguqzvojsv .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#kguqzvojsv .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#kguqzvojsv .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#kguqzvojsv .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#kguqzvojsv .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kguqzvojsv .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kguqzvojsv .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kguqzvojsv .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#kguqzvojsv .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#kguqzvojsv .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#kguqzvojsv .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#kguqzvojsv .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#kguqzvojsv .gt_spanner_row {
  border-bottom-style: hidden;
}

#kguqzvojsv .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#kguqzvojsv .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#kguqzvojsv .gt_from_md > :first-child {
  margin-top: 0;
}

#kguqzvojsv .gt_from_md > :last-child {
  margin-bottom: 0;
}

#kguqzvojsv .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#kguqzvojsv .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#kguqzvojsv .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#kguqzvojsv .gt_row_group_first td {
  border-top-width: 2px;
}

#kguqzvojsv .gt_row_group_first th {
  border-top-width: 2px;
}

#kguqzvojsv .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kguqzvojsv .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#kguqzvojsv .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#kguqzvojsv .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kguqzvojsv .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kguqzvojsv .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#kguqzvojsv .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#kguqzvojsv .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#kguqzvojsv .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kguqzvojsv .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kguqzvojsv .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kguqzvojsv .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kguqzvojsv .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kguqzvojsv .gt_left {
  text-align: left;
}

#kguqzvojsv .gt_center {
  text-align: center;
}

#kguqzvojsv .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#kguqzvojsv .gt_font_normal {
  font-weight: normal;
}

#kguqzvojsv .gt_font_bold {
  font-weight: bold;
}

#kguqzvojsv .gt_font_italic {
  font-style: italic;
}

#kguqzvojsv .gt_super {
  font-size: 65%;
}

#kguqzvojsv .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#kguqzvojsv .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#kguqzvojsv .gt_indent_1 {
  text-indent: 5px;
}

#kguqzvojsv .gt_indent_2 {
  text-indent: 10px;
}

#kguqzvojsv .gt_indent_3 {
  text-indent: 15px;
}

#kguqzvojsv .gt_indent_4 {
  text-indent: 20px;
}

#kguqzvojsv .gt_indent_5 {
  text-indent: 25px;
}

#kguqzvojsv .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#kguqzvojsv div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading">
<td colspan="4" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>Boundary Crossing and Power</td>
    </tr>
<tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="analysis">Analysis</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="n_cross_upper">N Cross Upper</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="cum_prob_cross_upper">Cum Power (Sim)</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="design_cum_power">Cum Power (Design)</th>
    </tr>
</thead>
<tbody class="gt_table_body">
<tr>
<td headers="analysis" class="gt_row gt_right">1</td>
<td headers="n_cross_upper" class="gt_row gt_right">13</td>
<td headers="cum_prob_cross_upper" class="gt_row gt_right">0.26</td>
<td headers="design_cum_power" class="gt_row gt_right">1.000</td>
</tr>
<tr>
<td headers="analysis" class="gt_row gt_right">2</td>
<td headers="n_cross_upper" class="gt_row gt_right">17</td>
<td headers="cum_prob_cross_upper" class="gt_row gt_right">0.60</td>
<td headers="design_cum_power" class="gt_row gt_right">1.000</td>
</tr>
<tr>
<td headers="analysis" class="gt_row gt_right">3</td>
<td headers="n_cross_upper" class="gt_row gt_right">13</td>
<td headers="cum_prob_cross_upper" class="gt_row gt_right">0.86</td>
<td headers="design_cum_power" class="gt_row gt_right">1.000</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level3">
<h3 id="overall-power">Overall power<a class="anchor" aria-label="anchor" href="#overall-power"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Determine if each simulation crossed the efficacy boundary at any analysis</span></span>
<span><span class="va">efficacy_by_sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="va">all_results</span><span class="op">)</span><span class="op">[</span></span>
<span>  ,</span>
<span>  <span class="fu">.</span><span class="op">(</span>efficacy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">cross_upper</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  by <span class="op">=</span> <span class="va">sim</span></span>
<span><span class="op">]</span></span>
<span></span>
<span><span class="va">overall_power</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">efficacy_by_sim</span><span class="op">$</span><span class="va">efficacy</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Futility stopping</span></span>
<span><span class="va">futility_by_sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="va">all_results</span><span class="op">)</span><span class="op">[</span></span>
<span>  ,</span>
<span>  <span class="fu">.</span><span class="op">(</span>futility <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">cross_lower</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">cross_upper</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  by <span class="op">=</span> <span class="va">sim</span></span>
<span><span class="op">]</span></span>
<span></span>
<span><span class="va">overall_futility</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">futility_by_sim</span><span class="op">$</span><span class="va">futility</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"=== Overall Operating Characteristics ==="</span><span class="op">)</span></span>
<span><span class="co">#&gt; === Overall Operating Characteristics ===</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Number of simulations: %d"</span>, <span class="va">n_sims</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Number of simulations: 50</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Overall Power (P[reject H0]): %.1f%%"</span>, <span class="va">overall_power</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Overall Power (P[reject H0]): 86.0%</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Futility Stopping Rate: %.1f%%"</span>, <span class="va">overall_futility</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Futility Stopping Rate: 14.0%</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Design Power (target): %.1f%%"</span>, <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">gs_nb</span><span class="op">$</span><span class="va">beta</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Design Power (target): 90.0%</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visualization-of-z-statistics">Visualization of Z-statistics<a class="anchor" aria-label="anchor" href="#visualization-of-z-statistics"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prepare data for plotting</span></span>
<span><span class="va">plot_data</span> <span class="op">&lt;-</span> <span class="va">all_results</span></span>
<span><span class="va">plot_data</span><span class="op">$</span><span class="va">z_flipped</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="va">plot_data</span><span class="op">$</span><span class="va">z_stat</span> <span class="co"># Flip for efficacy direction</span></span>
<span></span>
<span><span class="co"># Boundary data</span></span>
<span><span class="va">bounds_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  analysis <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,</span>
<span>  upper <span class="op">=</span> <span class="va">gs_nb</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">bound</span>,</span>
<span>  lower <span class="op">=</span> <span class="va">gs_nb</span><span class="op">$</span><span class="va">lower</span><span class="op">$</span><span class="va">bound</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">plot_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">analysis</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">z_flipped</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html" class="external-link">geom_violin</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"steelblue"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, color <span class="op">=</span> <span class="st">"steelblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.1</span>, fill <span class="op">=</span> <span class="st">"white"</span>, outlier.shape <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Draw bounds as lines connecting analyses</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">bounds_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">analysis</span>, y <span class="op">=</span> <span class="va">upper</span>, group <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"darkgreen"</span>, linewidth <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">bounds_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">analysis</span>, y <span class="op">=</span> <span class="va">lower</span>, group <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"darkred"</span>, linewidth <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Draw points for bounds</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bounds_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">analysis</span>, y <span class="op">=</span> <span class="va">upper</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"darkgreen"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bounds_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">analysis</span>, y <span class="op">=</span> <span class="va">lower</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"darkred"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"gray50"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Simulated Z-Statistics by Analysis"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Green dashed = efficacy bound, Red dashed = futility bound"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Analysis"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Z-statistic (positive = favors experimental)"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 44 rows containing non-finite outside the scale range</span></span>
<span><span class="co">#&gt; (`stat_ydensity()`).</span></span>
<span><span class="co">#&gt; Warning: Removed 44 rows containing non-finite outside the scale range</span></span>
<span><span class="co">#&gt; (`stat_boxplot()`).</span></span></code></pre></div>
<p><img src="group-sequential-simulation_files/figure-html/plot-z-stats-1.png" class="r-plt" alt="Z-statistics across analyses with group sequential boundaries" width="672"></p>
</div>
</div>
<div class="section level2">
<h2 id="notes">Notes<a class="anchor" aria-label="anchor" href="#notes"></a>
</h2>
<p>This simulation demonstrates the basic workflow for group sequential
designs with negative binomial outcomes:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Sample size calculation</strong> using
<code><a href="../reference/sample_size_nbinom.html">sample_size_nbinom()</a></code> for a fixed design</li>
<li>
<strong>Group sequential design</strong> using
<code><a href="../reference/gsNBCalendar.html">gsNBCalendar()</a></code> to add interim analyses</li>
<li>
<strong>Simulation</strong> using <code><a href="../reference/nb_sim.html">nb_sim()</a></code> to generate
trial data</li>
<li>
<strong>Analysis</strong> using <code><a href="../reference/cut_data_by_date.html">cut_data_by_date()</a></code> and
<code><a href="../reference/mutze_test.html">mutze_test()</a></code> at each interim</li>
<li>
<strong>Boundary checking</strong> against the group sequential
bounds</li>
</ol>
<p>The <code>usTime = c(0.1, 0.2, 1)</code> specification provides
conservative alpha spending at early analyses, preserving most of the
Type I error for later analyses when more information is available.</p>
<p>With only 50 simulations, the estimated power has substantial Monte
Carlo error. For more precise estimates, increase <code>n_sims</code> to
1000 or more.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Keaven Anderson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
