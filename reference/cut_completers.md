# Cut data for completers analysis

Subsets the data to subjects who have completed follow-up by the
specified date, and prepares the data for analysis.

## Usage

``` r
cut_completers(data, cut_date, event_gap = 5/365.25)
```

## Arguments

- data:

  Data generated by
  [`nb_sim()`](https://keaven.github.io/gsDesignNB/reference/nb_sim.md).

- cut_date:

  Calendar time (relative to trial start) at which to cut the data.

- event_gap:

  Gap duration after each event during which no new events are counted.
  Can be a numeric value (default `5 / 365.25`) or a function returning
  a numeric value. The time at risk is reduced by the sum of these gaps
  (truncated by the cut date).

## Value

A data frame with one row per subject who has completed follow-up by
`cut_date`. Contains the truncated follow-up time (`tte`) and total
number of observed events (`events`).

## Examples

``` r
enroll_rate <- data.frame(rate = 20 / (5 / 12), duration = 5 / 12)
fail_rate <- data.frame(treatment = c("Control", "Experimental"), rate = c(0.5, 0.3))
dropout_rate <- data.frame(
  treatment = c("Control", "Experimental"),
  rate = c(0.1, 0.05), duration = c(100, 100)
)
sim <- nb_sim(enroll_rate, fail_rate, dropout_rate, max_followup = 2, n = 20)
# Find date when 5 subjects have completed
date_5 <- cut_date_for_completers(sim, 5)
# Get analysis dataset for these completers
cut_completers(sim, date_5)
#>   id    treatment enroll_time      tte events
#> 1  1      Control  0.00419837 2.000000      0
#> 2  2 Experimental  0.03844758 2.000000      0
#> 3  3      Control  0.14626653 1.986311      1
#> 4  4 Experimental  0.16402103 2.000000      0
#> 5  5      Control  0.17372445 1.986311      1
```
